\chapter{Standard proof of the De Moivre-Laplace theorem}

In this chapter I want to prove the theorem by de Moivre and Laplace whereby I want to follow the basic ideas of their original proof\footnote{You can find similar proofs without error estimations in \cite[pp. 64-67]{irle}, \cite[pp. 131-134]{georgii} and \cite{wiki:demoivrelaplace}}. So we will first derive Stirling's formula of the factorial with which we will find an approximation of the binomial's probability mass function. This approximation will be used to deduce de Moivre's and Laplace's theorem.

\section{Stirling's formula}

Without proof the following theorem\footnote{cf.~\cite[pp. 505, 63]{heuser}} will be used in this section:

\begin{theorem}[Wallis' product]
  It is:

  \begin{align}
    \lim_{n\to\infty} \frac{2^2\cdot4^2\cdot6^2\dots(2n)^2}{1^2\cdot3^2\cdot5^2\dots(2n-1)^2}\cdot \frac{1}{2n} = \lim_{n\to\infty} \frac{1}{2n} \cdot \frac{2^{4n}}{\binom{2n}{n}^2} = \frac{\pi}{2}
  \end{align}
\end{theorem}

\noindent A proof of this equality can be found in~\cite[pp. 504-505]{heuser}. From this equation directly follows:

\begin{align} \label{wallis}
  \lim_{n\to\infty} \frac{2^{2n}}{\sqrt n \binom{2n}{n}} = \lim_{n\to\infty} \sqrt{\frac 1n \cdot \frac{2^{4n}}{\binom{2n}{n}^2}} = \sqrt \pi
\end{align}

\noindent Besides we will also need the Euler–Maclaurin formula~\cite[p. 226]{koenigsberger}:

\begin{theorem}[Euler–Maclaurin formula]
  Let $f:[1,n]\to\R$ be a $2n+1$-times continuously differentiable function. Let $\bn$ be the $n$th Bernoulli number and let $\bp{x}$ be the $n$th periodic Bernoulli polynomial. It is

  \begin{multline} \label{euler-maclaurin-formula}
    \sum_{k=1}^n f(k) = \int_1^n f(x)\d{x} + \frac{f(1)+f(n)}{2} + \sum_{k=1}^n \frac{\bn[2k]}{(2k)!} \Big[f^{(2k-1)}(n) - f^{(2k-1)}(1)\Big] \nl
     + \int_1^n \frac{\bp[2n+1]{x}}{(2n+1)!} f^{(2n+1)}(x) \d{x}
  \end{multline}
\end{theorem}

The periodic Bernoulli polynomials $\bps$ are defined on $[0,1)$ by the following properties~\cite[p. 291]{koenigsberger}:

\begin{enumerate}
  \item $\bp[0]{x} = 1$
  \item $\bps[n+1]'(x) = (n+1)\cdot \bp{x}$
  \item $\int_0^1 \bp{x} \d{x} = 0$
\end{enumerate}

The definition of $\bps$ on $[0,1)$ is then periodically continued to the whole domain $\R$~\cite[pp.~225, 291]{koenigsberger}. The Bernoulli numbers $\bn$ fulfill $\bn=\bp{0}$~\cite[p.~290]{koenigsberger}. All odd Bernoulli numbers $\bn[2n-1]$ for $n>1$ are zero and for the even Bernoulli numbers we get~\cite[p.~289]{koenigsberger}:

\begin{align}
  \bn[2] = \frac 16;\quad \bn[4]=-\frac{1}{30};\quad \bn[6]=\frac{1}{42};\quad \ldots
\end{align}

You can find a proof of the Euler-Maclaurin formula in~\cite[pp.~225-226]{koenigsberger} and~\cite[pp.~506-509]{heuser}. With the above two theorems we can derive Stirling's formula~(cf.~\cite[p.~228]{koenigsberger}):

\begin{theorem}[Stirling's formula]
  The factorial $n!$ fulfills:

  \begin{align}
    n! \in \sqrt{2\pi n} \left(\frac ne\right)^n \fexp{\frac 1{12n} + \bigabs{\frac{1}{120n^2}} }
  \end{align}

  \noindent Therefore

  \begin{align}
     n! \in \sqrt{2\pi n} \left(\frac ne\right)^n \fexp{\bigo{\frac 1n}}
  \end{align}
\end{theorem}

\begin{proof}
  In the proof we will follow~\cite[pp. 227-228]{koenigsberger}. First we apply the Euler-Maclaurin formula~\eqref{euler-maclaurin-formula} to $\ln(n!)=\sum_{k=1}^n \ln(k)$:

  \begin{align}
    \ln(n!) & = \sum_{k=1}^n \ln(k) \nl
    & = \int_1^n \ln(x) \d{x} + \frac{\ln(1)+\ln(n)}{2} + \frac{\bn[2]}{2!} \Big[\ln'(n)-\ln'(1)\Big] + \int_1^n \frac{\bp[3]{x}}{3!} \ln^{(3)}(x) \d{x} \nl
    &= \int_1^n \ln(x) \d{x} + \frac 12 \ln(n) + \frac{1}{12} \left(\frac 1n - 1\right) + \frac 13 \int_1^n \frac{\bp[3]{x}}{x^3} \d{x} \nl
    & \begin{comment}
      \int_1^n \ln(x) \d{x} = \Big[x\ln(x)-x\Big]_1^n = n\ln(n)-n+1
    \end{comment} \nonumber \nl
    &= n\ln(n)-n+\frac 12 \ln(n) + \frac{1}{12n} + \frac{11}{12} + \frac{1}{3} \int_1^n \frac{\bp[3]{x}}{x^3}\d{x} 
  \end{align}

  \noindent Thus

  \begin{align}
    \ln(n!) - n\ln(n) + n - \frac 12 \ln(n) = \frac{11}{12} + \frac{1}{12n} + \frac 13 \int_1^n \frac{\bp[3]{x}}{x^3} \d{x}
  \end{align}

  $\bps[3]$ is on $[0,1)$ as part of a polynomial bounded. Because $\bps[3]$ is $1$-periodic, $\bps[3]$ is bounded on the whole domain $\R$. Thus $\int_1^\infty \frac{\bp[3]{x}}{x^3} \d{x}$ exists because $\int_1^\infty \frac 1{x^3} d{x} < \infty$. Now we define $\seq{b_n}$ via

  \begin{align}
    b_n = \frac{n!}{n^n e^{-n} \sqrt{n}}
  \end{align}
  This sequence converges because
  \begin{align}
    \lim_{n\to\infty} \ln(b_n) & = \lim_{n\to\infty} \Big( \ln(n!) -n \ln(n) + n - \frac 12\ln(n) \Big) \nl
    & = \lim_{n\to\infty} \left( \frac{11}{12} + \frac{1}{12n} + \frac 13\int_1^n \frac{\bp[3]{x}}{x^3} \d{x}\right) \nl
    & = \frac{11}{12} + \frac 13\int_1^{\infty} \frac{\bp[3]{x}}{x^3} \d{x}
  \end{align}
  Let $b=\lim_{n\to\infty} b_n$. To calculate this limit we investigate $\tfrac{b_n^2}{b_{2n}}$:
  \begin{align}
    \lim_{n\to\infty} \frac{b_n^2}{b_{2n}} &= \lim_{n\to\infty} \frac{(n!)^2}{n^{2n}e^{-2n} n} \cdot \frac{(2n)^{2n} e^{-2n} \sqrt{2n}}{(2n)!} \nl
    &= \lim_{n\to\infty} \sqrt{2} \frac{2^{2n}}{\sqrt{n}\binom{2n}{n}} \nl
    & \begin{comment}
    \lim_{n\to\infty} \frac{2^{2n}}{\sqrt{n}\binom{2n}{n}} = \sqrt{\pi} \text{, see \eqref{wallis}}
    \end{comment} \nonumber \nl
    & = \sqrt{2\pi}
  \end{align}

  \noindent On the other hand we have

  \begin{align}
    \lim_{n\to\infty} \frac{b_n^2}{b_{2n}} = \frac{b^2}{b} = b
  \end{align}

  \noindent Thus $\lim_{n\to\infty} b_n = \sqrt{2\pi}$. From this we can follow

  \begin{align}
    \lim_{n\to\infty} \frac{n!}{\sqrt{2\pi n}n^n e^{-n}} = \lim_{n\to\infty} \frac{b_n}{\sqrt{2\pi}} = 1
  \end{align}

  This proves that $n!$ can be approximated by $\sqrt{2\pi n}n^n e^{-n}$ for large $n$. To estimate the error of this approximation we first calculate $\ln(n!)-\ln\left(\sqrt{2\pi n}n^n e^{-n}\right)$:

  \begin{align}
    \ln\left(\frac{n!}{\sqrt{2\pi n}n^n e^{-n}}\right) & = \ln\left(\frac{b_n}{\sqrt{2\pi}}\right) \nl
    &= \ln(b_n)-\ln\left(\sqrt{2\pi}\right) \nl
    &= \ln(b_n)-\lim_{n\to\infty} \ln(b_n) \nl
    &\begin{comment}
      \begin{aligned}
        \ln(b_n) &= \ln(n!)-n\ln(n)+n-\frac 12\ln(n) \nl
        &= \frac{11}{12} + \frac{1}{12n} + \frac 13 \int_1^n \frac{\bp[3]{x}}{x^3} \d{x}
      \end{aligned}
    \end{comment} \nl
    &= \frac{11}{12} + \frac{1}{12n} + \frac 13 \int_1^n \frac{\bp[3]{x}}{x^3} \d{x} -\left(\frac{11}{12}  + \frac 13 \int_1^\infty \frac{\bp[3]{x}}{x^3} \d{x}\right) \nl
    &= \frac{1}{12n}-\frac 13\int_n^\infty \frac{\bp[3]{x}}{x^3} \d{x}
  \end{align}

  On $[0,1)$ the periodic Bernoulli polynomial has the form $\bp[3]{x} = x^3-\frac 32 x^2 + \frac 12 x$~\cite[p.~290]{koenigsberger}. It has roots at $x=0$ and $x=1$. Its derivative $\bps[3]'(x) = 3x^2-3x+\tfrac 12$ has two distinct roots at $x = \frac 12 \pm \sqrt{\frac 1{12}}$. Thus $\bps[3]$ has local extrema at $x=\frac 12 \pm \sqrt{1{12}}$. Because $\bp[3]{0}=\bp[3]{1}=0$ and $\bps[3]$ is 1-periodic its supremum is

  \begin{align}
    \snorm{\bps[3]} = \max\left\{\abs{\bp[3]{\frac 12 + \sqrt{\frac{1}{12}}}}, \abs{\bp[3]{\frac 12 - \sqrt{\frac{1}{12}}}}\right\} \approx 0.0481 \le 0.05 = \frac{1}{20}
  \end{align}

  \noindent Thus

  \begin{align}
    \abs{\frac 13\int_n^\infty \frac{\bp[3]{x}}{x^3} \d{x}} & \le \frac 13 \int_n^\infty \frac{\abs{\bp[3]{x}}}{x^3} \d{x} \nl
    & \le \frac{\snorm{\bps[3]}}{3} \int_n^\infty \frac 1{x^3} \d{x} \nl
    & \le \frac{1}{60} \left[-\frac{1}{2x^2}\right]_n^\infty \nl
    & = \frac 1{120n^2}
  \end{align}

  \noindent So

  \begin{align}
    & \ln\left(\frac{n!}{\sqrt{2\pi n}n^n e^{-n}}\right) = \frac 1{12n} - \frac 13 \int_n^\infty \frac{\bp[3]{x}}{x^3} \d{x} \in \frac 1{12n} + \bigabs{\frac{1}{120n^2}} \bnl
    \implies & n! \in \sqrt{2\pi n} \left(\frac ne\right)^n \fexp{\frac 1{12n} + \bigabs{\frac 1{120n^2}}} \bnl
    &
    \begin{comment}
      \frac 1{12n} + \bigabs{\frac 1{120n^2}} \subseteq \bigo{\frac 1n}
    \end{comment} \bnl
    \implies & n! \in \sqrt{2\pi n} \left(\frac ne\right)^n \fexp{\bigo{\frac 1n}}
  \end{align}
\end{proof}

\section{Local version of de Moivre-Laplace theorem}

In this section we will show that the probability mass function of the standardized binomial distribution can be approximated by the density function of the normal distribution. This will be the basis for the global version of de Moivre-Laplace theorem. The following proof is based on the ideas given by Iosif Pinelis\cite{iosif}.

\begin{theorem}[Local version of de Moivre-Laplace theorem]
  Let $\pol{\x}$ be the set of all polynomials in $\x$. Let $\seq{c_n}$ be a sequence with $\seq{c_n} \in \littleo{\frac 1h}$. For all $\x$ with $0\le k\le n$ and $\abs{x_k} \le c_n$ we have
  \begin{align}
    \bb{x_k} &= \binom nk p^k q^{n-k} \nl
    &\in \fphi{\x} h +\frac{q-p}6 \left(\x^3-\x\right) \fphi{\x} h^2 + \bigo{\fphi{\x}\pol{\x}h^3}
  \end{align}
\end{theorem}

\begin{proof}
  We have
  \begin{align}
    k &= np + \x \sqrt{npq} \nl
    &= np \left( 1 + \x \frac{\sqrt{q}}{\sqrt{np}}\right) \nl
    &= np \left( 1 + \x q h\right)
  \end{align}
  For $n-k$ we get
  \begin{align}
    n-k &= n-np-\x\sqrt{npq} \nl
    &= nq -\x \sqrt{npq} \nl
    &= nq \left( 1 + \x \frac{\sqrt p}{\sqrt{nq}}\right) \nl
    &= nq \left( 1 - \x p h\right)
  \end{align}
  Because $\x h \in \littleo{1}$ we have
  \begin{align}
    k & \in np \cdot \bigo{1} \nl
    n-k & \in nq \cdot \bigo{1}
  \end{align}
  Because $\seq{1+a_n} \in \fexp{a_n + \bigo{a_n^2}}$ we can also conclude
  \begin{align}
    k &\in np \cdot \fexp{\x q h + \bigo{\pol{\x}h^2}} \nl
    n-k &\in nq \cdot \fexp{\x p h + \bigo{\pol{\x}h^2}}
  \end{align}

  \noindent This we can use for the approximation

  \begin{align}
    \bb{\x} &= \binom nk p^k q^{n-k} \nl
    &= \frac{n!}{k!(n-k)!} p^k q^{n-k} \bnl
    & \begin{comment} \text{Stirling's formula} \end{comment} \bnl
    &\in \frac{\sqrt{2\pi n}n^n e^{-n} \fe{\bigo{\frac 1n}}}{\sqrt{2\pi k}k^k e^{-k} \fe{\bigo{\frac 1k}}\cdot \sqrt{2\pi (n-k)}(n-k)^{n-k} e^{-(n-k)}\fe{\bigo{\frac 1{n-k}}}} \cdot p^k q^{n-k} \bnl
    & \subseteq \sqrt{\frac{n}{2\pi k (n-k)}} \frac{n^n}{k^k(n-k)^{(n-k)}}\cdot p^k q^{n-k} \fe{\bigo{\frac 1n} + \bigo{\frac 1k} + \bigo{\frac 1{n-k}}} \bnl
    &
    \begin{comment}
      \begin{array}{rll}
        \frac 1k & \in \frac1{np} \cdot \bigo{1} & \subseteq \bigo{\frac 1n} \bnl
        \frac 1{n-k} & \in \frac1{nq} \cdot \bigo{1} & \subseteq \bigo{\frac 1n} \bnl
        \frac 1n & \in \bigo{h^2}
      \end{array}
    \end{comment} \bnl
    & \subseteq \sqrt{\frac{n}{2\pi k (n-k)}} \left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k} \fe{\bigo{h^2}}
  \end{align}

  Now we first approximate the two main factors of the remaining product. We start with the root $\sqrt{\frac{n}{2\pi k(n-k)}}$:

  \begin{align}
    \sqrt{\frac{n}{2\pi k(n-k)}} & \in \sqrt{\frac{n}{2\pi \cdot np \fexp{\x qh +\bigo{\pol{x}h^2}} \cdot nq \fexp{-\x ph + \bigo{\pol{\x}h^2}}}} \bnl
    & \subseteq \sqrt{\frac{1}{2\pi npq \fexp{(q-p)\x h +\bigo{\pol{x}h^2}}}} \bnl
    & \subseteq \frac{1}{\sqrt{2\pi npq}} \fexp{\frac{p-q}2 \x h + \bigo{\pol{\x}h^2}}
  \end{align}

  \noindent In order to approximate $\left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k}$ we investigate its logarithm

  \begin{align}
    \ln\left(\left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k}\right) & = k \ln\left(\frac{np}{k}\right) + (n-k) \ln\left(\frac{nq}{n-k}\right) \nl
    &=-n \left[ \frac kn \ln\left(\frac{k}{np}\right) + \left(1-\frac kn\right) \ln\left(\frac{1-\frac kn}{q}\right)\right] \nl
    &
    \begin{comment}
      \h{s} := -n\left[s \ln\left(\frac sp\right) + (1-s) \ln\left(\frac{1-s}{1-p}\right)\right]
    \end{comment} \nl
    &= \h{\frac kn}
  \end{align}

  \noindent The function $\h{s}$ has the derivatives

  \begin{align}
    h'(s) &= -n\left[\ln\left(\frac sp\right) - \ln\left(\frac{1-s}{1-p}\right)\right] \nl
    h''(s) &= -\frac ns - \frac n{1-s} \nl
    h^{(3)}(s) &= \frac n{s^2} - \frac n{(1-s)^2} \nl
    h^{(4)}(s) &= -\frac {2n}{s^3} - \frac {2n}{(1-s)^3}
  \end{align}

  \noindent We have

  \begin{align}
    h(p)& = 0 \nl
    h'(p)& =0 \nl
    h''(p) & = -\frac np - \frac nq = -\frac n{pq} \nl
    h^{(3)}(p) &= \frac n{p^2}-\frac{n}{q^2} = \frac{n\left(q^2-p^2\right)}{p^2q^2} \nl
    &
    \begin{comment}
      q^2-p^2 = (q-p)(q+p) = q-p
    \end{comment} \nl
    &= -\frac{n(p-q)}{p^2q^2}
  \end{align}

  \noindent Therefore the Taylor series of $\h{s}$ is

  \begin{align}
    h(s) = -\frac{n}{2pq} (s-p)^2 - \frac{n(p-q)}{6p^2q^2} (s-p)^3 + R(s)
  \end{align}

  with $R(s)=-\frac{2n}{4!} \left(\frac{1}{\tilde s^3}+\frac{1}{(1-\tilde s)^3}\right) (s-p)^4$ for a $\tilde s$ in the interval bounded by $s$ and $p$. We want to evaluate this series for $s=\frac kn$. Here we have $s-p=\x pqh$ and thus

  \begin{align}
    \begin{array}{rll}
      -\frac{n}{2pq} (s-p)^2 &= -\frac{n}{2pq} \x^2 p^2 q^2 h^2 & = -\frac{\x^2}{2} \nl
      -\frac{n(p-q)}{6p^2q^2} (s-p)^3 &= -\frac{n(p-q)}{6p^2q^2} \x^3p^3q^3h^3 & = -\frac{p-q}{6} \x^3 h
    \end{array}
  \end{align}

  Because $\tilde s$ is in the interval bounded by $p$ and $s=\frac kn \in p\fe{\littleo{1}}$ we deduce $\tilde s \in p\fe{\littleo{1}}\subseteq \bigo{1}$, too. Similarly we get $1-\tilde s\in q\fe{\littleo{1}} \subseteq \bigo{1}$ because $1-s = \frac{n-k}{n} \in q\fe{\littleo{1}}$. From this follows:

  \begin{align}
    \frac 1{\tilde s^3} + \frac 1{(1-\tilde s)^3} & \in \bigo{1}
  \end{align}

  \noindent So

  \begin{align}
    R(s) & = -\frac{2n}{4!} \left(\frac 1{\tilde s^3} + \frac 1{(1-\tilde s)^3}\right) (s-p)^4 \nl
    & \in -\frac{2n}{4!} \bigo{1} \x^4 p^4 q^4 h^4 \nl
    &
    \begin{comment}
      n h^2 \in \bigo{1}
    \end{comment} \nl
    & \subseteq \bigo{\pol{\x} h^2}
  \end{align}

  \noindent Thus

  \begin{align}
    \h{\frac kn} &=-\frac{n}{2pq} (s-p)^2 - \frac{n(p-q)}{6p^2q^2} (s-p)^3 + R(s) \nl
    & \in -\frac{\x^2}{2} - \frac{p-q}{6} \x^3 h + \bigo{\pol{\x} h^2}
  \end{align}

  \noindent Finally

  \begin{align}
    \left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k} & = \fexp{\h{\frac kn}} \bnl
    & \in \fexp{-\frac{\x^2}{2} - \frac{p-q}{6} \x^3 h + \bigo{\pol{\x} h^2}} \bnl
    & \subseteq \fexp{-\frac{\x^2}{2}} \fexp{-\frac{p-q}6 \x^3 h + \bigo{\pol{\x} h^2}}
  \end{align}

  \noindent Now we can complete the approximation

  \begin{align}
    \bb{\x} & \in \sqrt{\frac{n}{2\pi k(n-k)}} \left(\frac {np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k} \fe{\bigo{h^2}} \bnl
    &
    \begin{comment}
      \begin{aligned}
        \sqrt{\frac{n}{2\pi k(n-k)}} & \in \frac1{\sqrt{2\pi npq}} \fexp{\frac{p-q}2 \x h + \bigo{\pol{\x}h^2}}\bnl
        \left(\frac {np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k} & \in \fexp{-\frac{\x^2}2} \fexp{-\frac{p-q}6 \x^3 h + \bigo{\pol{\x}h^2}}
      \end{aligned}
    \end{comment} \bnl
    & \subseteq \frac 1{\sqrt{2\pi npq}} \cdot \fexp{-\frac{\x^2}{2}} \fexp{\frac{p-q}2 \left(\x  - \frac 13 \x^3\right) h + \bigo{\pol{\x}h^2}} \bnl
    &
    \begin{comment}
      \fexp{a_n} \in \left(1+a_n+\bigo{a_n^2}\right)
    \end{comment} \bnl
    & \subseteq \frac 1{\sqrt{2\pi npq}} \cdot \fexp{-\frac{\x^2}{2}} \left(1 +\frac{p-q}2 \left(\x - \frac 13 \x^3 \right) h + \bigo{\pol{\x}h^2}\right) \bnl
    &
    \begin{comment}
      \fphi{x} = \frac{1}{\sqrt{npq}}\fexp{-\frac{x^2}2}
    \end{comment} \bnl
    & \subseteq \fphi{\x} h +\frac{q-p}6 \left(\x^3-\x\right) \fphi{\x} h^2 + \bigo{\fphi{\x}\pol{\x}h^3}
  \end{align}
\end{proof}

\section{First global version of de Moivre-Laplace}

\begin{theorem}[First global version of de Moivre-Laplace]
  Let $a,b\in \R$ with $a \le b$. We have
  \begin{align}
    \P{a \le \BBs \le b} & = \sum_{a \le \x \le b} \bb{\x} \nl
    &
    \begin{multlined}
      \in \int_a^b \fphi{t} \d{t} + \frac{q-p}6 \left[\br{b^2-1}\fphi{b}-\br{a^2-1}\fphi{a}\right] \nl
      +\bigabs{\snorm{\phi}h}+ \bigo{h^2}
    \end{multlined}
  \end{align}
\end{theorem}

\begin{proof}
  In the following we will only consider those $n\in\N$ with $\x[0] \le a \le b \le \x[n]$. Because $\lim_{n\to\infty} \x[0] = -\infty$ and $\lim_{n\to\infty} \x[n] = \infty$ these are almost all $n\in\N$. Because $c_n=\max\{\abs{a},\abs{b}\}$ is a sequence with $c_n\in\littleo{\frac 1h}$ and for all $\x$ with $a \le \x \le b$ we have $\abs{\x} \le c_n$ we can apply the local version of de Moivre-Laplace and we get

  \begin{align}
    \sum_{a \le \x \le b} \bb{\x} \in \sum_{a \le \x \le b} \br{\fphi{\x} h +\frac{q-p}6 \left(\x^3 - \x\right) \fphi{\x} h^2 + \bigo{\fphi{\x}\pol{\x}h^3}}
  \end{align}

  We have three Riemann sums. For any $\f{x}=\fphi{x}p(x)$ with a polynomial $p(x)$ we have $\snorm{f} < \infty$ and $\snorm{f'}<\infty$. So we apply the following rule from theorem \ref{thm:arithmetic_rules}

  \begin{align}
    \sum_{a \le \x \le b} \f{\x} h & \in \int_a^b \f{t} \d{t} + \bigabs{\snorm{f}h + \frac 14 \snorm{f'} (b-a) h + \frac 14 \snorm{f'} h^2} \bnl
    & \subseteq  \int_a^b \f{t} \d{t} + \bigo{h}
  \end{align}
  Thus we have for the third sum
  \begin{align}
    \sum_{a \le \x \le b} \bigo{\fphi{\x} \pol{\x} h^3} & \subseteq \bigo{\int_a^b \fphi{t} \pol{t} \d{t} \cdot h^2 + \bigo{h^3}} \subseteq \bigo{h^2}
  \end{align}
  For the second term we get
  \begin{align}
    \sum_{a \le \x \le b} \frac{q-p}6 \br{\x^3 - x} \fphi{\x} h^2 &\in \frac{q-p}6 \int_a^b \br{t^3-t}\fphi{t} \d{t} \cdot h + \bigo{h^2} \bnl
    &= \frac{q-p}6 \left[ \br{t^2-1}\fphi{t} \right]_a^b h + \bigo{h^2} \bnl
    &= \frac{q-p}6 \left[ \br{b^2-1}\fphi{b} - \br{a^2-1}\fphi{a} \right] h + \bigo{h^2}
  \end{align}
  For $\sum_{a\le b\le b} \fphi{\x}h$ we need a better approximation. From the following equation
  \begin{align}
    \int_{\x-\frac h2}^{\x+\frac h2} \fphi{t} \d{t} & = \int_{-\frac h2}^{+\frac h2} \frac{\fphi{\x+t}+\fphi{\x-t}}2 \d{t} \bnl
    & = \fphi{\x} \int_{-\frac h2}^{\frac h2} \fcosh{\x t} \fexp{-\frac{t^2}2} \d{t} \bnl
    &
    \begin{comment}
      \fcosh{\x t}\fexp{-\frac{t^2}2} = 1 + \bigo{t^3}
    \end{comment} \bnl
    & \in \fphi{\x} h + \bigo{h^3}
  \end{align}

  \noindent we can follow

  \begin{align}
    \fphi{\x} h \in \int_{\x-\frac h2}^{\x+\frac h2} \fphi{t} \d{t} + \bigo{h^3}
  \end{align}

  \noindent and thus (let $\tilde a=\xup{a}$ and $\tilde b=\xdown{b}$)

  \begin{align}
    \sum_{a \le \x \le b} \fphi{\x} h &\in \sum_{a \le \x \le b} \br{\int_{\x-\frac h2}^{\x+\frac h2} \fphi{t} \d{t} + \bigo{h^3}} \bnl
    &\subseteq \int_{\tilde a - \frac h2}^{\tilde b+\frac h2} \fphi{t} \d{t} + \bigo{h^2} \bnl
    &\subseteq \int_a^b \fphi{t} \d{t} + \bigabs{\snorm{\phi} h} + \bigo{h^2}
  \end{align}

  \noindent So we get

  \begin{align}
    \sum_{a\le \x \le b} \bb{\x} &\in \sum_{a \le \x \le b} \left(\fphi{\x} h +\frac{q-p}6 \left(\x^3 - \x\right) \fphi{\x} h^2 + \bigo{\fphi{\x}\pol{\x}h^3}\right) \bnl
    &
    \begin{comment}
      \begin{aligned}
        \sum_{a \le \x \le b} \fphi{\x} h & \in \int_a^b \fphi{t} \d{t} + \bigabs{\snorm{\phi} h} + \bigo{h^2} \bnl
        \sum_{a \le \x \le b} \frac{q-p}6 \br{\x^3-\x} \fphi{\x} h^2 & \in \frac{q-p}6 \int_a^b \br{t^3-t} \fphi{t} \d{t}\cdot h + \bigo{h^2} \bnl
        \sum_{a \le \x \le b} \bigo{\fphi{\x}\pol{x}h^3} &\subseteq \bigo{h^2}
      \end{aligned}
    \end{comment} \bnl
    &
    \begin{multlined}
      \subseteq \int_a^b \fphi{t} \d{t} + \frac{q-p}6 \left[\br{b^2-1}\fphi{b}-\br{a^2-1}\fphi{a}\right] h \nl
      + \bigabs{\snorm{\phi}h} + \bigo{h^2}
    \end{multlined}
  \end{align}
\end{proof}

\section{Second global version of the de Moivre-Laplace theorem}

\todo{Chernof bound}

\begin{theorem}[Second global version of the de Moivre-Laplace theorem]
  For any $z\in\R$ we find

  \begin{align}
    \P{\BBs \le z} &= \sum_{\x \le z} \bb{\x} \bnl
    & \in \int_{-\infty}^z \fphi{t} \d{t} + \frac{q-p}6 \br{z^2-1}\fphi{z} h + \littleo{h}
  \end{align}
\end{theorem}

\begin{proof}
  We consider only those $n\in\N$ with $\x[0] \le z \le \x[n]$. Because $\lim_{n\to\infty} \x[0] = -\infty$ and $\lim_{n\to\infty} \x[n] = \infty$ these are almost all $n\in\N$. Let $\seq{c_n}$ be a sequence with $\x[0] \le c_n \le \min\{z,0\}$, $\seq{\abs{c_n}}\in\littleo{\frac 1h}$ and $\lim_{n\to\infty} c_n=-\infty$. We split the sum $\sum_{\x \le z} \bb{\x}$ into two sums:

  \begin{align}
    \sum_{\x \le z} \bb{\x} = \sum_{\x < c_n} \bb{\x} + \sum_{c_n \le \x \le z} \bb{\x}
  \end{align}
  The first sum can be estimated with the \todo{Chernoff bound}:
  \begin{align}
    0 \le \sum_{\x < c_n} \bb{\x} \le \P{\abs{\BBs} > \abs{c_n}} \le 2\fexp{-\frac{c_n^2}{4}}
  \end{align}
  Similarly we get
  \begin{align}
    0 \le \int_{t < c_n} \fphi{t}\d{t} \le \int_{\abs{t} > \abs{c_n}} \fphi{t} \d{t} \le 2\fexp{-\frac{c_n^2}{4}}
  \end{align}
  Thus
  \begin{align}
    \sum_{\x < c_n} \bb{\x} & \in \int_{t < c_n} \fphi{t}\d{t} + \bigabs{2\fexp{-\frac{c_n^2}4}} \nl
    &
    \begin{comment}
      \text{\todo{}} 
    \end{comment} \nl
    & \subseteq \int_{t < c_n} \fphi{t}\d{t} + \littleo{h}
  \end{align}

  The second sum can be approximated as in the above theorem. Because $\abs{\x} \le \max\{\abs{c_n},z\} \in \littleo{\frac 1h}$ we can apply the local version of de Moivre-Laplace and we get
  \begin{align}
    \sum_{c_n \le \x \le z} \bb{\x} = \sum_{c_n \le \x \le z} \br{\fphi{\x} h +\frac{q-p}6 \left(\x^3 - \x\right) \fphi{\x} h^2 + \bigo{\fphi{\x}\pol{\x}h^3}}
  \end{align}
  Now we have for any $f(x)=\fphi{x}p(x)$ with $p(x)$ being a polynomial:
  \begin{align}
    \sum_{c_n \le \x \le b} \f{\x} h & \in \int_{c_n}^b \f{t} \d{t} + \bigabs{\snorm{f}h + \frac 14 \snorm{f'} (b-c_n) h + \frac 14 \snorm{f'} h^2} \nl
    &
    \begin{comment}
      (b-c_n)h \in \littleo{1}
    \end{comment} \nl
    & \subseteq  \int_{c_n}^b \f{t} \d{t} + \littleo{1}
  \end{align}
  Therefore
  \begin{align}
    \sum_{c_n \le \x \le z} \bigo{\fphi{\x}\pol{\x}h^3} \in \bigo{\int_{c_n}^z \fphi{t} \d{t} \cdot h^2 + \littleo{h^2}} \subseteq \littleo{h}
  \end{align}
  and
  \begin{align}
    \sum_{c_n \le \x \le z} \frac{q-p}6 \br{\x^3-\x} \fphi{\x} h^2 &\in \frac{q-p}6 \int_{c_n}^z \br{t^3-t} \fphi{t} \d{t} \cdot h + \littleo{h} \bnl
    &
    \begin{multlined}
      = \frac{q-p}6 \int_{-\infty}^z \br{t^3-t} \fphi{t} \d{t} \cdot h \bnl
      - \frac{q-p}6 \int_{-\infty}^{c_n} \br{t^3-t} \fphi{t} \d{t} \cdot h + \littleo{h}
    \end{multlined} \bnl
    &
    \begin{comment}
      \lim_{n\to\infty} c_n = -\infty \implies \lim_{n\to\infty} \int_{-\infty}^{c_n} \br{t^3-t} \fphi{t} \d{t} = 0
    \end{comment} \bnl
    & = \frac{q-p}6 \int_{-\infty}^z \br{t^3-t} \fphi{t} \d{t} \cdot h + \littleo{h} \bnl
    & = \frac{q-p}6 \left[\br{t^2-1} \fphi{t}\right]_{-\infty}^{z} \cdot h + \littleo{h} \bnl
    & = \frac{q-p}6 \br{z^2-1} \fphi{z} \cdot h + \littleo{h}
  \end{align}
  As in the previous proof we have
  \begin{align}
    \sum_{c_n \le \x \le z} \fphi{\x} h &\in \sum_{c_n \le \x \le z} \br{\int_{\x-\frac h2}^{\x+\frac h2} \fphi{t}\d{t} + \bigo{h^3}} \bnl
    &
    \begin{comment}
      (z-c_n)h \in \littleo{1}
    \end{comment} \bnl
    &\subseteq \int_{c_n}^z \fphi{t} \d{t} + \bigabs{\snorm{\phi} h} + \littleo{h} \bnl
    &\subseteq \int_{c_n}^z \fphi{t} \d{t} + \littleo{h}
  \end{align}
  So we can summarize
  \begin{align}
    \sum_{c_n \le \x \le z} \bb{\x} & \in \sum_{c_n \le \x \le z} \br{\fphi{\x} h +\frac{q-p}6 \br{\x^3 - \x} \fphi{\x} h^2 + \bigo{\fphi{\x}\pol{\x}h^3}} \bnl
    &
    \begin{comment}
      \begin{aligned}
        \sum_{c_n \le \x \le z} \fphi{\x} h &\in \int_{c_n}^z \fphi{t} \d{t} + \littleo{h} \bnl
        \sum_{c_n \le \x \le z} \frac{q-p}6 \br{\x^3-\x} \fphi{\x} h^2 &\in \frac{q-p}6 \br{z^2-1} \fphi{z} \cdot h + \littleo{h} \bnl
        \sum_{c_n \le \x \le z} \bigo{\fphi{\x}\pol{\x}h^3} & \in \littleo{h}
      \end{aligned}
    \end{comment} \bnl
    & \subseteq \int_{c_n}^z \fphi{t} \d{t} + \frac{q-p}6 \br{z^2-1}\fphi{z} h + \littleo{h}
  \end{align}

  \noindent So we can finish the proof

  \begin{align}
    \sum_{\x \le z} \bb{\x} & = \sum_{\x < c_n} \bb{\x} + \sum_{c_n \le \x \le z} \bb{\x} \bnl
    & \in \int_{t < c_n} \fphi{t} \d{t} + \int_{c_n}^z \fphi{t} \d{t} + \frac{q-p}6 \br{z^2-1}\fphi{z} h + \littleo{h} \bnl
    & \in \int_{-\infty}^z \fphi{t} \d{t} + \frac{q-p}6 \br{z^2-1}\fphi{z} h + \littleo{h}
  \end{align}
\end{proof}

\section{Conclusion}

We see that the standard proof of the de Moivre-Laplace theorem with Stirling's formula yield a good estimation of the approximation's error. We do not only get the right order $\bigo{h}$ of the error's convergence as it is shown by the Berry-Esseen theorem, we also derived a better approximation for the binomial distribution which is

\begin{align}
  \P{\BBs = \x}& \approx \fphi{\x} h +\frac{q-p}6 \left(\x^3-\x\right) \fphi{\x} h^2 \nl
  \P{a \le \BBs \le b} & \approx  \int_a^b \fphi{t} \d{t} + \frac{q-p}6 \left[\br{b^2-1}\fphi{b}-\br{a^2-1}\fphi{a}\right] h \nl
  \P{\BBs \le z} & \approx \int_{-\infty}^z \fphi{t} \d{t} + \frac{q-p}6 \br{z^2-1}\fphi{z} h
\end{align}

These extensions of the normal approximation are precisely the first two terms of the Edgeworth Expansion \cite[pp. 39 ff.]{hall}\cite{wiki:edgeworth}. The Edgeworth Expansion is a series which approximates the cumulative distribution function of a random variable \cite{wiki:edgeworth}. In the case of the binomial distribution the Edgeworth Expansion is
\begin{align}
  \P{\BBs \le z} & \approx \int_{-\infty}^z \fphi{t} \d{t} + \frac{q-p}6 \br{z^2-1}\fphi{z} h + R\left(\frac{\sqrt n z - n \x[m]}h\right)\frac{\fphi{z}}{\sqrt n}h + \bigo{h^2}
\end{align}
with $R(x)=\lfloor x \rfloor -x+\frac 12$ and $\x[m]$ is any of the $\x$ (for example the mode of $\bbs$). By comparing the above equation with our second global version of de Moivre-Laplace we see that we can provide the same first term of the Edgeworth Expansion, but with a worse error estimation of the remaining error ($\littleo{h}$ instead of $\bigo{h^2}$). This demonstrates the power of the standard proof with Stirling's formula.

\todo{Folgendes sollte untersucht werden: Vergleich mit numerischen Diagrammen.} \todo{Uspensky: Introduction to probability}

