\chapter{Standard proof of the De Moivre-Laplace theorem}

In this chapter I want to prove the theorem by de Moivre and Laplace whereby I want to follow the basic ideas of their original proof\footnote{You can find similar proofs without error estimations in \cite[pp. 64-67]{irle}, \cite[pp. 131-134]{georgii} and \cite{wiki:demoivrelaplace}}. So we will first derive Stirling's formula of the factorial with which we will find an approximation of the binomial's probability mass function. This approximation will be used to deduce de Moivre's and Laplace's theorem.

\section{Stirling's formula}

Without proof the following theorem\footnote{cf.~\cite[pp. 505, 63]{heuser}} will be used in this section:

\begin{theorem}[Wallis' product]
  It is:

  \begin{align}
    \lim_{n\to\infty} \frac{2^2\cdot4^2\cdot6^2\dots(2n)^2}{1^2\cdot3^2\cdot5^2\dots(2n-1)^2}\cdot \frac{1}{2n} = \lim_{n\to\infty} \frac{1}{2n} \cdot \frac{2^{4n}}{\binom{2n}{n}^2} = \frac{\pi}{2}
  \end{align}
\end{theorem}

\noindent A proof of this equality can be found in~\cite[pp. 504-505]{heuser}. From this equation directly follows: 

\begin{align} \label{wallis}
  \lim_{n\to\infty} \frac{2^{2n}}{\sqrt n \binom{2n}{n}} = \lim_{n\to\infty} \sqrt{\frac 1n \cdot \frac{2^{4n}}{\binom{2n}{n}^2}} = \sqrt \pi
\end{align}

\noindent Besides we will also need the Euler–Maclaurin formula~\cite[p. 226]{koenigsberger}:

\begin{theorem}[Euler–Maclaurin formula]
  Let $f:[1,n]\to\R$ be a $2n+1$-times continuously differentiable function. Let $\bn$ be the $n$th Bernoulli number and let $\bp{x}$ be the $n$th periodic Bernoulli polynomial. It is

  \begin{multline} \label{euler-maclaurin-formula}
    \sum_{k=1}^n f(k) = \int_1^n f(x)\d{x} + \frac{f(1)+f(n)}{2} + \sum_{k=1}^n \frac{\bn[2k]}{(2k)!} \Big[f^{(2k-1)}(n) - f^{(2k-1)}(1)\Big] \nl
     + \int_1^n \frac{\bp[2n+1]{x}}{(2n+1)!} f^{(2n+1)}(x) \d{x}
  \end{multline}
\end{theorem}

The periodic Bernoulli polynomials $\bps$ are defined on $[0,1)$ by the following properties~\cite[p. 291]{koenigsberger}:

\begin{enumerate}
  \item $\bp[0]{x} = 1$
  \item $\bps[n+1]'(x) = (n+1)\cdot \bp{x}$
  \item $\int_0^1 \bp{x} \d{x} = 0$
\end{enumerate}

The definition of $\bps$ on $[0,1)$ is then periodically continued to the whole domain $\R$ \todo{how? / cite}. The Bernoulli numbers $\bn$ fulfill $\bn=\bp{0}$~\cite[p.~290]{koenigsberger}. All odd Bernoulli numbers $\bn[2n-1]$ for $n>1$ are zero and for the even Bernoulli numbers we get~\cite[p.~289]{koenigsberger}:

\begin{align}
  \bn[2] = \frac 16;\quad \bn[4]=-\frac{1}{30};\quad \bn[6]=\frac{1}{42};\quad \ldots
\end{align}

You can find a proof of the Euler-Maclaurin formula in~\cite[pp.~225-226]{koenigsberger} and~\cite[pp.~506-509]{heuser}. With the above two theorems we can derive Stirling's formula~(cf.~\cite[p.~228]{koenigsberger}):

\begin{theorem}[Stirling's formula]
  The factorial $n!$ fulfills:

  \begin{align}
    n! \in \ean[\frac 1n]{\sqrt{2\pi n} \left(\frac ne\right)^n}
  \end{align}
\end{theorem}

\begin{proof}
  In the proof we will follow~\cite[pp. 227-228]{koenigsberger}. First we apply the Euler-Maclaurin formula~\eqref{euler-maclaurin-formula} to $\ln(n!)=\sum_{k=1}^n \ln(k)$:

  \begin{align}
    \ln(n!) & = \sum_{k=1}^n \ln(k) \nl
    & = \int_1^n \ln(x) \d{x} + \frac{\ln(1)+\ln(n)}{2} + \frac{\bn[2]}{2!} \Big[\ln'(n)-\ln'(1)\Big] + \int_1^n \frac{\bp[3]{x}}{3!} \ln^{(3)}(x) \d{x} \nl
    &= \int_1^n \ln(x) \d{x} + \frac 12 \ln(n) + \frac{1}{12} \left(\frac 1n - 1\right) + \frac 13 \int_1^n \frac{\bp[3]{x}}{x^3} \d{x} \nl
    & \begin{comment}
      \int_1^n \ln(x) \d{x} = \Big[x\ln(x)-x\Big]_1^n = n\ln(n)-n+1
    \end{comment} \nonumber \nl
    &= n\ln(n)-n+\frac 12 \ln(n) + \frac{1}{12n} + \frac{11}{12} + \frac{1}{3} \int_1^n \frac{\bp[3]{x}}{x^3}\d{x} 
  \end{align}

  \noindent Thus

  \begin{align}
    \ln(n!) - n\ln(n) + n - \frac 12 \ln(n) = \frac{11}{12} + \frac{1}{12n} + \frac 13 \int_1^n \frac{\bp[3]{x}}{x^3} \d{x}
  \end{align}

  $\bps[3]$ is on $[0,1)$ as part of a polynomial bounded. Because $\bps[3]$ is $1$-periodic, $\bps[3]$ is bounded on the whole domain $\R$. Thus $\int_1^\infty \frac{\bp[3]{x}}{x^3} \d{x}$ exists because $\int_1^\infty \frac 1{x^3} d{x} < \infty$. Now we define $\seq{b_n}$ via

  \begin{align}
    b_n = \frac{n!}{n^n e^{-n} \sqrt{n}}
  \end{align}

  \noindent This sequence converges because

  \begin{align}
    \lim_{n\to\infty} \ln(b_n) & = \lim_{n\to\infty} \Big( \ln(n!) -n \ln(n) + n - \frac 12\ln(n) \Big) \nl
    & = \lim_{n\to\infty} \left( \frac{11}{12} + \frac{1}{12n} + \frac 13\int_1^n \frac{\bp[3]{x}}{x^3} \d{x}\right) \nl
    & = \frac{11}{12} + \frac 13\int_1^{\infty} \frac{\bp[3]{x}}{x^3} \d{x}
  \end{align}

  \noindent Let $b=\lim_{n\to\infty} b_n$. To calculate this limit we investigate $\tfrac{b_n^2}{b_{2n}}$:

  \begin{align}
    \lim_{n\to\infty} \frac{b_n^2}{b_{2n}} &= \lim_{n\to\infty} \frac{(n!)^2}{n^{2n}e^{-2n} n} \cdot \frac{(2n)^{2n} e^{-2n} \sqrt{2n}}{(2n)!} \nl
    &= \lim_{n\to\infty} \sqrt{2} \frac{2^{2n}}{\sqrt{n}\binom{2n}{n}} \nl
    & \begin{comment}
    \lim_{n\to\infty} \frac{2^{2n}}{\sqrt{n}\binom{2n}{n}} = \sqrt{\pi} \text{, see \eqref{wallis}}
    \end{comment} \nonumber \nl
    & = \sqrt{2\pi}
  \end{align}

  \noindent On the other hand we have

  \begin{align}
    \lim_{n\to\infty} \frac{b_n^2}{b_{2n}} = \frac{b^2}{b} = b
  \end{align}

  \noindent Thus $\lim_{n\to\infty} b_n = \sqrt{2\pi}$. From this we can follow

  \begin{align}
    \lim_{n\to\infty} \frac{n!}{\sqrt{2\pi n}n^n e^{-n}} = \lim_{n\to\infty} \frac{b_n}{\sqrt{2\pi}} = 1
  \end{align}

  This proves that $n!$ can be approximated by $\sqrt{2\pi n}n^n e^{-n}$ for large $n$. To estimate the error of this approximation we first calculate $\ln(n!)-\ln\left(\sqrt{2\pi n}n^n e^{-n}\right)$:

  \begin{align}
    \ln\left(\frac{n!}{\sqrt{2\pi n}n^n e^{-n}}\right) & = \ln\left(\frac{b_n}{\sqrt{2\pi}}\right) \nl
    &= \ln(b_n)-\ln\left(\sqrt{2\pi}\right) \nl
    &= \ln(b_n)-\lim_{n\to\infty} \ln(b_n) \nl
    &\begin{comment}
      \begin{aligned}
        \ln(b_n) &= \ln(n!)-n\ln(n)+n-\frac 12\ln(n) \nl
        &= \frac{11}{12} + \frac{1}{12n} + \frac 13 \int_1^n \frac{\bp[3]{x}}{x^3} \d{x}
      \end{aligned}
    \end{comment} \nl
    &= \frac{11}{12} + \frac{1}{12n} + \frac 13 \int_1^n \frac{\bp[3]{x}}{x^3} \d{x} -\left(\frac{11}{12}  + \frac 13 \int_1^\infty \frac{\bp[3]{x}}{x^3} \d{x}\right) \nl
    &= \frac{1}{12n}-\frac 13\int_n^\infty \frac{\bp[3]{x}}{x^3} \d{x}
  \end{align}

  On $[0,1)$ the periodic Bernoulli polynomial has the form $\bp[3]{x} = x^3-\frac 32 x^2 + \frac 12 x$~\cite[p.~290]{koenigsberger}. It has roots at $x=0$ and $x=1$. Its derivative $\bps[3]'(x) = 3x^2-3x+\tfrac 12$ has two distinct roots at $x = \frac 12 \pm \sqrt{\frac 1{12}}$. Thus $\bps[3]$ has local extrema at $x=\frac 12 \pm \sqrt{1{12}}$. Because $\bp[3]{0}=\bp[3]{1}=0$ and $\bps[3]$ is 1-periodic its supremum is

  \begin{align}
    \snorm{\bps[3]} = \max\left\{\abs{\bp[3]{\frac 12 + \sqrt{\frac{1}{12}}}}, \abs{\bp[3]{\frac 12 - \sqrt{\frac{1}{12}}}}\right\} \approx 0.0481 \le 0.05 = \frac{1}{20}
  \end{align}

  \noindent Thus

  \begin{align}
    \abs{\frac 13\int_n^\infty \frac{\bp[3]{x}}{x^3} \d{x}} & \le \frac 13 \int_n^\infty \frac{\abs{\bp[3]{x}}}{x^3} \d{x} \nl
    & \le \frac{\snorm{\bps[3]}}{3} \int_n^\infty \frac 1{x^3} \d{x} \nl
    & \le \frac{1}{60} \left[-\frac{1}{2x^2}\right]_n^\infty \nl
    & = \frac 1{120n^2}
  \end{align}

  \noindent So\footnote{At this point we also may have deduced $\ln\left(\frac{n!}{\sqrt{2\pi n}n^n e^{-n}}\right) \in \an[\frac1{120n^2}]{\frac 1{12n}}$ from which follows

  \begin{align}
    n! \in \ean[\frac 1{120n^2}]{\sqrt{2\pi n} \left(\frac ne\right)^n e^{\frac 1{12n}}}
  \end{align}

  This gives a better approximation with a better error bound. For the following sections we do not need such a good approximation.

  \todo{better design -> clearpage?! Sieht sonst blöd aus mit der Fußnote am Seitenende}
  }

  \begin{align}
    \abs{\ln\left(\frac{n!}{\sqrt{2\pi n}n^n e^{-n}}\right)} & = \abs{\frac 1{12n}-\frac 13 \int_n^\infty \frac{\bp[3]{x}}{x^3} \d{x}} \nl
    & \le \frac 1{12n} + \abs{\frac 13\int_n^\infty \frac{\bp[3]{x}}{x^3} \d{x}} \nl
    & \le \frac 1{12n} + \frac{1}{120n^2} \nl
    & \le \frac 1{2n} + \frac{1}{2n} \nl
    & = \frac{1}{n}
  \end{align}

  \noindent From the above inequality follows

  \begin{align}
    \sqrt{2\pi n}n^n e^{-n} e^{-\frac 1n} \le n! \le \sqrt{2\pi n} n^n e^n
  \end{align}

  \noindent or

  \begin{align}
    n! \in \ean[\frac 1n]{\sqrt{2\pi n} \left(\frac ne\right)^n}
  \end{align}
\end{proof}

\section{The local version of de Moivre-Laplace theorem}

In this section we will show that the probability mass function of the standardized binomial distribution can be approximated by the density function of the normal distribution. This will be the basis for the global version of de Moivre-Laplace theorem.

\begin{theorem}[Local version of de Moivre-Laplace theorem]
  Let $C \in \Rplus$. For $\abs{\x} \le \bigpsi{C}$ we have

  \begin{align}
    \bb{k} = \binom nk p^k q^{n-k} & \in \ean[\bigpsi{\frac{1}{2\sqrt{npq}} \cdot C + \frac{p^2+q^2}{6\sqrt{npq}} \cdot C^3}]{\frac{1}{\sqrt{2\pi npq} \exp\left(-\frac{(k-np)^2}{2npq}\right)}} \nl
    & = \ean[\bigpsi{\frac{1}{2} Ch + \frac{p^2+q^2}{6} \cdot C^3h}]{\frac{1}{\sqrt{2\pi}} \exp\left(-\frac{\x}{2}\right) h}
  \end{align}
\end{theorem}

\begin{proof}
  Note that $\abs{\x}\le \bigpsi{C}$ means that there is a sequence $\seq{\epsilon_n}$ with $\limsup_{n\to\infty} \frac{\epsilon_n}{C} \le 1$ and $\abs{\x} \le \epsilon_n$. First we investigate what $\abs{\x} \le \bigpsi{C}$ means for $k$ and $n-k$:

  \begin{align}
    \begin{array}{rrl}
      & \abs{\x} & \le \bigpsi{C} \bnl
      \implies & \abs{\frac{k-np}{\sqrt{npq}}} & \le \bigpsi{C} \bnl
      \implies & \abs{k-np} & \le \bigpsi{C\sqrt{npq}} \bnl
      \implies & \abs{\frac k{np}-1} & \le \bigpsi{\frac{C\sqrt{q}}{\sqrt{np}}} \bnl
      && \begin{comment}
       \abs{\frac ab-1} \le \epsilon \implies a \in \ean[\epsilon]{b}
      \end{comment} \bnl
      \implies & k & \in \ean[\bigpsi{\frac{C\sqrt{q}}{\sqrt{np}}}]{np} \bnl
      \implies & k & \in \ean[\bigpsi{qCh}]{np}
    \end{array}
  \end{align}

  \noindent For $n-k$ we get

  \begin{align}
    \begin{array}{rrl}
      & \abs{\x} & \le \bigpsi{C} \bnl
      \implies & \abs{\frac{k-np}{\sqrt{npq}}} & \le \bigpsi{C} \bnl
      \implies & \abs{np-k} & \le \bigpsi{C\sqrt{npq}} \bnl
      \implies & \abs{n-k-nq} & \le \bigpsi{C\sqrt{npq}} \bnl
      \implies & \abs{\frac {n-k}{nq}-1} & \le \bigpsi{\frac{C\sqrt{p}}{\sqrt{nq}}} \bnl
      && \begin{comment}
       \abs{\frac ab-1} \le \epsilon \implies a \in \ean[\epsilon]{b}
      \end{comment} \bnl
      \implies & k & \in \ean[\bigpsi{\frac{C\sqrt{p}}{\sqrt{nq}}}]{nq} \bnl
      \implies & k & \in \ean[\bigpsi{pCh}]{nq}
    \end{array}
  \end{align}

  \noindent We have

  \begin{align}
    \bb{\x} &= \binom nk p^k q^{n-k} \nl
    &= \frac{n!}{k!(n-k)!} p^k q^{n-k} \nl
    & \begin{comment} \text{Stirling's formula} \end{comment} \nl
    &\in \frac{\ean[\frac 1n]{\sqrt{2\pi n}n^n e^{-n}}}{\ean[\frac 1k]{\sqrt{2\pi k}k^k e^{-k}}\cdot \ean[\frac 1n]{\sqrt{2\pi (n-k)}(n-k)^{n-k} e^{-(n-k)}}} \cdot p^k q^{n-k} \bnl
    & \subseteq \ean[\frac 1n + \frac 1k + \frac 1{n-k}]{\sqrt{\frac{n}{2\pi k (n-k)}} \frac{n^n}{k^k(n-k)^{(n-k)}}\cdot p^k q^{n-k}} \bnl
    & \subseteq \ean[\frac 1n + \frac 1k + \frac 1{n-k}]{\sqrt{\frac{n}{2\pi k (n-k)}} \left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k}} \bnl
    &
    \begin{comment}
      \begin{aligned}
        \frac 1k + \frac 1{n-k} & = \frac{n}{k(n-k)} \bnl
        & \in \frac{n}{\ean[qCh]{np}\cdot \ean[pCh]{nq}} \bnl
        & = \ean[Ch]{\frac{1}{npq}} \bnl
        & \subseteq \ean[\littleo{1}]{\frac{1}{npq}} \nl
        & \subseteq \bigpsi{\frac{1}{npq}} = \bigpsi{h^2}
      \end{aligned}
    \end{comment} \bnl
    & \subseteq \ean[\frac 1n + \bigpsi{h^2}]{\sqrt{\frac{n}{2\pi k (n-k)}} \left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k}} \bnl
    &
    \begin{comment}
      \frac 1n \in \bigpsi{\frac 1n} = \bigpsi{\frac{pq}{npq}} = \bigpsi{pq h^2}
    \end{comment} \bnl
    & \subseteq \ean[\bigpsi{(1+pq)h^2}]{\sqrt{\frac{n}{2\pi k (n-k)}} \left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k}} \bnl
  \end{align}

  Now we first approximate the two main factors of the remaining product. We start with the root $\sqrt{\frac{n}{2\pi k(n-k)}}$: 

  \begin{align}
    \sqrt{\frac{n}{2\pi k(n-k)}} & \in \sqrt{\frac{n}{2\pi \ean[qCh]{np} \ean[pCh]{nq}}} \nl
    &
    \begin{comment}
      \lambda \cdot \ean[\epsilon]{a} \cdot \ean[\delta]{b} = \ean[\epsilon+\delta]{\lambda ab}
    \end{comment} \nl
    & = \sqrt{\ean[Ch]{\frac{1}{2\pi npq}}} \nl
    &
    \begin{comment}
      \ean[\epsilon]{a}^\alpha = \ean[\alpha \cdot \epsilon]{a^\alpha}
    \end{comment} \nl
    & = \ean[\frac 12 Ch]{\frac 1{\sqrt{2\pi npq}}}
  \end{align}

  \noindent In order to approximate $\left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k}$ we investigate its logarithm

  \begin{align}
    \ln\left(\left(\frac{np}{k}\right)^k \left(\frac{nq}{n-k}\right)^{n-k}\right) & = k \ln\left(\frac{np}{k}\right) + (n-k) \ln\left(\frac{nq}{n-k}\right) \nl
    &=-n \left[ \frac kn \ln\left(\frac{k}{np}\right) + \left(1-\frac kn\right) \ln\left(\frac{1-\frac kn}{q}\right)\right] \nl
    &
    \begin{comment}
      \h{s} := s \ln\left(\frac sp\right) + (1-s) \ln\left(\frac{1-s}{1-p}\right)
    \end{comment} \nl
    &=-n \h{\frac kn}
  \end{align}

  \noindent The function $\h{s}$ has the derivatives

  \begin{align}
    h'(s) &= \ln\left(\frac sp\right) - \ln\left(\frac{1-s}{1-p}\right) \nl
    h''(s) &= \frac 1s + \frac 1{1-s} \nl
    h^{(3)}(s) &= -\frac 1{s^2} + \frac 1{(1-s)^2}
  \end{align}

  \noindent We have $h(p)=h'(p)=0$ and $h''(p) = \frac 1p + \frac 1q = \frac 1{pq}$. Therefore the Taylor series of $\h{s}$ is

  \begin{align}
    h(s) = \frac{1}{2pq} (s-p)^2 + R(s)
  \end{align}

  \noindent with $R(s)=\frac{1}{3!} \left(\frac{1}{(1-\tilde s)^2}-\frac{1}{\tilde s^2}\right) (s-p)^3$ for a $\tilde s$ in the interval bounded by $s$ and $p$. 
\end{proof}
